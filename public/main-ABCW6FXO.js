import{$ as N,A as o,B as i,C as f,F as A,G as S,H as g,I as r,K as k,M as E,N as M,R as h,S as C,T as O,U as w,V as D,W as R,X as P,Y as T,Z as b,_ as l,j as I,k as L,p as s,r as u,s as c,w as d,y as p}from"./chunk-HDPR4ZAD.js";import{f as m}from"./chunk-PZ5UXJ7I.js";function B(t,n){if(t&1&&(o(0,"h1"),r(1),i()),t&2){let e=g();s(),k(" Bienvenidos",e.rol?", "+e.rol+" "+e.apellido+" "+e.nombre+",":"",` a la Cl\xEDnica Online
`)}}function Z(t,n){t&1&&(o(0,"div",2),f(1,"div",3),o(2,"p"),r(3,"Cargando usuario..."),i()())}var q=b(l.apiUrl,l.publicAnonKey),v=class t{isLoading=!0;nombre="";apellido="";rol="";mail=void 0;ngOnInit(){return m(this,null,function*(){let{data:n,error:e}=yield q.auth.getUser();n?.user&&(this.nombre=localStorage.getItem("nombre")||"",this.apellido=localStorage.getItem("apellido")||"",this.rol=localStorage.getItem("rol")||"",this.mail=n.user.email,console.log("Email del usuario:",this.mail)),this.isLoading=!1})}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["app-home"]],decls:4,vars:2,consts:[[4,"ngIf"],["class","spinner-container",4,"ngIf"],[1,"spinner-container"],[1,"spinner"]],template:function(e,a){e&1&&(o(0,"title"),r(1,"Home"),i(),d(2,B,2,1,"h1",0)(3,Z,4,0,"div",1)),e&2&&(s(2),p("ngIf",!a.isLoading),s(),p("ngIf",a.isLoading))},dependencies:[C,h],styles:["h1[_ngcontent-%COMP%]{font-family:Poppins,sans-serif;font-weight:600;color:#0d6efd;text-align:center;margin-top:20px}.spinner-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-top:20px}.spinner[_ngcontent-%COMP%]{border:4px solid #f3f3f3;border-top:4px solid #28a745;border-radius:50%;width:40px;height:40px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"]})};var x=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=c({type:t,selectors:[["app-error"]],decls:2,vars:0,template:function(e,a){e&1&&(o(0,"h1"),r(1,"404 p\xE1gina no encontrada"),i())},encapsulation:2})};var F=[{path:"",pathMatch:"full",redirectTo:"home"},{path:"home",component:v},{path:"login",loadComponent:()=>import("./chunk-H7IFLKXO.js").then(t=>t.LoginComponent)},{path:"register",loadComponent:()=>import("./chunk-IS674RM6.js").then(t=>t.RegisterComponent)},{path:"**",component:x}];var U={providers:[E({eventCoalescing:!0}),T(F)]};function z(t,n){t&1&&(o(0,"button",5),r(1,"Login"),i())}function G(t,n){t&1&&(o(0,"button",6),r(1,"Registro"),i())}function J(t,n){if(t&1){let e=A();o(0,"button",7),S("click",function(){I(e);let V=g();return L(V.logout())}),r(1,"Cerrar Sesi\xF3n"),i()}}var y=b(l.apiUrl,l.publicAnonKey),_=class t{constructor(n,e,a){this.router=n;this.cd=e;this.authService=a}isLoggedIn=!1;ngOnInit(){return m(this,null,function*(){yield this.checkSession(),y.auth.onAuthStateChange((n,e)=>{this.isLoggedIn=!!e?.user,this.cd.detectChanges()})})}checkSession(){return m(this,null,function*(){let{data:n}=yield y.auth.getSession();this.isLoggedIn=!!n.session?.user,this.cd.detectChanges()})}logout(){return m(this,null,function*(){try{let{data:n}=yield y.auth.getSession();if(!n?.session){console.warn("\u26A0 No hay una sesi\xF3n activa.");return}let{error:e}=yield y.auth.signOut();if(e){console.error("\u26A0 Error al cerrar sesi\xF3n:",e.message);return}this.isLoggedIn=!1,this.authService.logout(),this.cd.detectChanges(),this.router.navigate(["/login"])}catch(n){console.error("\u26A0 Error inesperado al cerrar sesi\xF3n:",n)}})}static \u0275fac=function(e){return new(e||t)(u(D),u(M),u(N))};static \u0275cmp=c({type:t,selectors:[["app-root"]],decls:7,vars:3,consts:[[1,"nav"],["routerLinkActive","selected","routerLink","home",1,"btn","btn-outline-primary"],["class","btn btn-outline-primary","routerLinkActive","selected","routerLink","login",4,"ngIf"],["class","btn btn-outline-primary","routerLinkActive","selected","routerLink","register",4,"ngIf"],["class","btn btn-outline-danger",3,"click",4,"ngIf"],["routerLinkActive","selected","routerLink","login",1,"btn","btn-outline-primary"],["routerLinkActive","selected","routerLink","register",1,"btn","btn-outline-primary"],[1,"btn","btn-outline-danger",3,"click"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"button",1),r(2,"Inicio"),i(),d(3,z,2,0,"button",2)(4,G,2,0,"button",3)(5,J,2,0,"button",4),i(),f(6,"router-outlet")),e&2&&(s(3),p("ngIf",!a.isLoggedIn),s(),p("ngIf",!a.isLoggedIn),s(),p("ngIf",a.isLoggedIn))},dependencies:[w,C,h,R,P],styles:[".nav[_ngcontent-%COMP%]{border-bottom:1px solid #ccc;margin-bottom:2rem;padding:1rem;display:flex;justify-content:center;align-items:center}.selected[_ngcontent-%COMP%]{background-color:#0056b3;border-radius:5px}h1[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]})};O(_,U).catch(t=>console.error(t));
